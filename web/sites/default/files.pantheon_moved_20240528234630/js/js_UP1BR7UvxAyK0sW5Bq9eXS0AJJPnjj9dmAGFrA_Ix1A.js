/* @license GNU-GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function($,_,Backbone,Drupal,drupalSettings,JSON,storage){var options=$.extend(drupalSettings.quickedit,{strings:{quickEdit:Drupal.t('Quick edit')}});var fieldsMetadataQueue=[];var fieldsAvailableQueue=[];var contextualLinksQueue=[];var entityInstancesTracker={};function initQuickEdit(bodyElement){Drupal.quickedit.collections.entities=new Drupal.quickedit.EntityCollection();Drupal.quickedit.collections.fields=new Drupal.quickedit.FieldCollection();Drupal.quickedit.app=new Drupal.quickedit.AppView({el:bodyElement,model:new Drupal.quickedit.AppModel(),entitiesCollection:Drupal.quickedit.collections.entities,fieldsCollection:Drupal.quickedit.collections.fields});}function processEntity(entityElement){var entityID=entityElement.getAttribute('data-quickedit-entity-id');if(!entityInstancesTracker.hasOwnProperty(entityID))entityInstancesTracker[entityID]=0;else entityInstancesTracker[entityID]++;var entityInstanceID=entityInstancesTracker[entityID];entityElement.setAttribute('data-quickedit-entity-instance-id',entityInstanceID);}function initializeField(fieldElement,fieldID,entityID,entityInstanceID){var entity=Drupal.quickedit.collections.entities.findWhere({entityID,entityInstanceID});$(fieldElement).addClass('quickedit-field');var field=new Drupal.quickedit.FieldModel({el:fieldElement,fieldID,id:"".concat(fieldID,"[").concat(entity.get('entityInstanceID'),"]"),entity,metadata:Drupal.quickedit.metadata.get(fieldID),acceptStateChange:_.bind(Drupal.quickedit.app.acceptEditorStateChange,Drupal.quickedit.app)});Drupal.quickedit.collections.fields.add(field);}function loadMissingEditors(callback){var loadedEditors=_.keys(Drupal.quickedit.editors);var missingEditors=[];Drupal.quickedit.collections.fields.each(function(fieldModel){var metadata=Drupal.quickedit.metadata.get(fieldModel.get('fieldID'));if(metadata.access&&_.indexOf(loadedEditors,metadata.editor)===-1){missingEditors.push(metadata.editor);Drupal.quickedit.editors[metadata.editor]=false;}});missingEditors=_.uniq(missingEditors);if(missingEditors.length===0){callback();return;}var loadEditorsAjax=Drupal.ajax({url:Drupal.url('quickedit/attachments'),submit:{'editors[]':missingEditors}});loadEditorsAjax.execute().then(callback);}function initializeEntityContextualLink(contextualLink){var metadata=Drupal.quickedit.metadata;function hasFieldWithPermission(fieldIDs){for(var i=0;i<fieldIDs.length;i++){var fieldID=fieldIDs[i];if(metadata.get(fieldID,'access')===true)return true;}return false;}function allMetadataExists(fieldIDs){return fieldIDs.length===metadata.intersection(fieldIDs).length;}var fields=_.where(fieldsAvailableQueue,{entityID:contextualLink.entityID,entityInstanceID:contextualLink.entityInstanceID});var fieldIDs=_.pluck(fields,'fieldID');if(fieldIDs.length===0)return false;if(hasFieldWithPermission(fieldIDs)){var entityModel=new Drupal.quickedit.EntityModel({el:contextualLink.region,entityID:contextualLink.entityID,entityInstanceID:contextualLink.entityInstanceID,id:"".concat(contextualLink.entityID,"[").concat(contextualLink.entityInstanceID,"]"),label:Drupal.quickedit.metadata.get(contextualLink.entityID,'label')});Drupal.quickedit.collections.entities.add(entityModel);var entityDecorationView=new Drupal.quickedit.EntityDecorationView({el:contextualLink.region,model:entityModel});entityModel.set('entityDecorationView',entityDecorationView);_.each(fields,function(field){initializeField(field.el,field.fieldID,contextualLink.entityID,contextualLink.entityInstanceID);});fieldsAvailableQueue=_.difference(fieldsAvailableQueue,fields);var initContextualLink=_.once(function(){var $links=$(contextualLink.el).find('.contextual-links');var contextualLinkView=new Drupal.quickedit.ContextualLinkView($.extend({el:$('<li class="quickedit"><a href="" role="button" aria-pressed="false"></a></li>').prependTo($links),model:entityModel,appModel:Drupal.quickedit.app.model},options));entityModel.set('contextualLinkView',contextualLinkView);});loadMissingEditors(initContextualLink);return true;}if(allMetadataExists(fieldIDs))return true;return false;}function extractEntityID(fieldID){return fieldID.split('/').slice(0,2).join('/');}function processField(fieldElement){var metadata=Drupal.quickedit.metadata;var fieldID=fieldElement.getAttribute('data-quickedit-field-id');var entityID=extractEntityID(fieldID);var entityElementSelector="[data-quickedit-entity-id=\"".concat(entityID,"\"]");var $entityElement=$(entityElementSelector);if(!$entityElement.length)throw new Error("Quick Edit could not associate the rendered entity field markup (with [data-quickedit-field-id=\"".concat(fieldID,"\"]) with the corresponding rendered entity markup: no parent DOM node found with [data-quickedit-entity-id=\"").concat(entityID,"\"]. This is typically caused by the theme's template for this entity type forgetting to print the attributes."));var entityElement=$(fieldElement).closest($entityElement);if(entityElement.length===0){var $lowestCommonParent=$entityElement.parents().has(fieldElement).first();entityElement=$lowestCommonParent.find($entityElement);}var entityInstanceID=entityElement.get(0).getAttribute('data-quickedit-entity-instance-id');if(!metadata.has(fieldID)){fieldsMetadataQueue.push({el:fieldElement,fieldID,entityID,entityInstanceID});return;}if(metadata.get(fieldID,'access')!==true)return;if(Drupal.quickedit.collections.entities.findWhere({entityID,entityInstanceID}))initializeField(fieldElement,fieldID,entityID,entityInstanceID);else fieldsAvailableQueue.push({el:fieldElement,fieldID,entityID,entityInstanceID});}function deleteContainedModelsAndQueues($context){$context.find('[data-quickedit-entity-id]').addBack('[data-quickedit-entity-id]').each(function(index,entityElement){var entityModel=Drupal.quickedit.collections.entities.findWhere({el:entityElement});if(entityModel){var contextualLinkView=entityModel.get('contextualLinkView');contextualLinkView.undelegateEvents();contextualLinkView.remove();entityModel.get('entityDecorationView').remove();entityModel.destroy();}function hasOtherRegion(contextualLink){return contextualLink.region!==entityElement;}contextualLinksQueue=_.filter(contextualLinksQueue,hasOtherRegion);});$context.find('[data-quickedit-field-id]').addBack('[data-quickedit-field-id]').each(function(index,fieldElement){Drupal.quickedit.collections.fields.chain().filter(function(fieldModel){return fieldModel.get('el')===fieldElement;}).invoke('destroy');function hasOtherFieldElement(field){return field.el!==fieldElement;}fieldsMetadataQueue=_.filter(fieldsMetadataQueue,hasOtherFieldElement);fieldsAvailableQueue=_.filter(fieldsAvailableQueue,hasOtherFieldElement);});}function fetchMissingMetadata(callback){if(fieldsMetadataQueue.length){var fieldIDs=_.pluck(fieldsMetadataQueue,'fieldID');var fieldElementsWithoutMetadata=_.pluck(fieldsMetadataQueue,'el');var entityIDs=_.uniq(_.pluck(fieldsMetadataQueue,'entityID'),true);entityIDs=_.difference(entityIDs,Drupal.quickedit.metadata.intersection(entityIDs));fieldsMetadataQueue=[];$.ajax({url:Drupal.url('quickedit/metadata'),type:'POST',data:{'fields[]':fieldIDs,'entities[]':entityIDs},dataType:'json',success:function success(results){_.each(results,function(fieldMetadata,fieldID){Drupal.quickedit.metadata.add(fieldID,fieldMetadata);});callback(fieldElementsWithoutMetadata);}});}}Drupal.behaviors.quickedit={attach:function attach(context){once('quickedit-init','body').forEach(initQuickEdit);var fields=once('quickedit','[data-quickedit-field-id]',context);if(fields.length===0)return;once('quickedit','[data-quickedit-entity-id]',context).forEach(processEntity);fields.forEach(processField);contextualLinksQueue=_.filter(contextualLinksQueue,function(contextualLink){return !initializeEntityContextualLink(contextualLink);});fetchMissingMetadata(function(fieldElementsWithFreshMetadata){_.each(fieldElementsWithFreshMetadata,processField);contextualLinksQueue=_.filter(contextualLinksQueue,function(contextualLink){return !initializeEntityContextualLink(contextualLink);});});},detach:function detach(context,settings,trigger){if(trigger==='unload')deleteContainedModelsAndQueues($(context));}};Drupal.quickedit={app:null,collections:{entities:null,fields:null},editors:{},metadata:{has:function has(fieldID){return storage.getItem(this._prefixFieldID(fieldID))!==null;},add:function add(fieldID,metadata){storage.setItem(this._prefixFieldID(fieldID),JSON.stringify(metadata));},get:function get(fieldID,key){var metadata=JSON.parse(storage.getItem(this._prefixFieldID(fieldID)));return typeof key==='undefined'?metadata:metadata[key];},_prefixFieldID:function _prefixFieldID(fieldID){return "Drupal.quickedit.metadata.".concat(fieldID);},_unprefixFieldID:function _unprefixFieldID(fieldID){return fieldID.substring(26);},intersection:function intersection(fieldIDs){var prefixedFieldIDs=_.map(fieldIDs,this._prefixFieldID);var intersection=_.intersection(prefixedFieldIDs,_.keys(sessionStorage));return _.map(intersection,this._unprefixFieldID);}}};var permissionsHashKey=Drupal.quickedit.metadata._prefixFieldID('permissionsHash');var permissionsHashValue=storage.getItem(permissionsHashKey);var permissionsHash=drupalSettings.user.permissionsHash;if(permissionsHashValue!==permissionsHash){if(typeof permissionsHash==='string')_.chain(storage).keys().each(function(key){if(key.substring(0,26)==='Drupal.quickedit.metadata.')storage.removeItem(key);});storage.setItem(permissionsHashKey,permissionsHash);}$(document).on('drupalContextualLinkAdded',function(event,data){if(data.$region.is('[data-quickedit-entity-id]')){if(!data.$region.is('[data-quickedit-entity-instance-id]')){once('quickedit',data.$region);processEntity(data.$region.get(0));}var contextualLink={entityID:data.$region.attr('data-quickedit-entity-id'),entityInstanceID:data.$region.attr('data-quickedit-entity-instance-id'),el:data.$el[0],region:data.$region[0]};if(!initializeEntityContextualLink(contextualLink))contextualLinksQueue.push(contextualLink);}});})(jQuery,_,Backbone,Drupal,drupalSettings,window.JSON,window.sessionStorage);;
(function($,Drupal){Drupal.quickedit.util=Drupal.quickedit.util||{};Drupal.quickedit.util.constants={};Drupal.quickedit.util.constants.transitionEnd='transitionEnd.quickedit webkitTransitionEnd.quickedit transitionend.quickedit msTransitionEnd.quickedit oTransitionEnd.quickedit';Drupal.quickedit.util.buildUrl=function(id,urlFormat){var parts=id.split('/');return Drupal.formatString(decodeURIComponent(urlFormat),{'!entity_type':parts[0],'!id':parts[1],'!field_name':parts[2],'!langcode':parts[3],'!view_mode':parts[4]});};Drupal.quickedit.util.networkErrorModal=function(title,message){var $message=$("<div>".concat(message,"</div>"));var networkErrorModal=Drupal.dialog($message.get(0),{title,dialogClass:'quickedit-network-error',buttons:[{text:Drupal.t('OK'),click:function click(){networkErrorModal.close();},primary:true}],create:function create(){$(this).parent().find('.ui-dialog-titlebar-close').remove();},close:function close(event){$(event.target).remove();}});networkErrorModal.showModal();};Drupal.quickedit.util.form={load:function load(options,callback){var fieldID=options.fieldID;var formLoaderAjax=Drupal.ajax({url:Drupal.quickedit.util.buildUrl(fieldID,Drupal.url('quickedit/form/!entity_type/!id/!field_name/!langcode/!view_mode')),submit:{nocssjs:options.nocssjs,reset:options.reset},error:function error(xhr,url){var fieldLabel=Drupal.quickedit.metadata.get(fieldID,'label');var message=Drupal.t('Could not load the form for <q>@field-label</q>, either due to a website problem or a network connection problem.<br>Please try again.',{'@field-label':fieldLabel});Drupal.quickedit.util.networkErrorModal(Drupal.t('Network problem!'),message);var fieldModel=Drupal.quickedit.app.model.get('activeField');fieldModel.set('state','candidate');}});formLoaderAjax.commands.quickeditFieldForm=function(ajax,response,status){callback(response.data,ajax);Drupal.ajax.instances[this.instanceIndex]=null;};formLoaderAjax.execute();},ajaxifySaving:function ajaxifySaving(options,$submit){var settings={url:$submit.closest('form').attr('action'),setClick:true,event:'click.quickedit',progress:false,submit:{nocssjs:options.nocssjs,other_view_modes:options.other_view_modes},success:function success(response,status){var _this=this;Object.keys(response||{}).forEach(function(i){if(response[i].command&&_this.commands[response[i].command])_this.commands[response[i].command](_this,response[i],status);});},base:$submit.attr('id'),element:$submit[0]};return Drupal.ajax(settings);},unajaxifySaving:function unajaxifySaving(ajax){$(ajax.element).off('click.quickedit');}};})(jQuery,Drupal);;
function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}(function(Drupal,Backbone){Drupal.quickedit.BaseModel=Backbone.Model.extend({initialize:function initialize(options){this.__initialized=true;return Backbone.Model.prototype.initialize.call(this,options);},set:function set(key,val,options){if(this.__initialized)if(_typeof(key)==='object')key.validate=true;else{if(!options)options={};options.validate=true;}return Backbone.Model.prototype.set.call(this,key,val,options);}});})(Drupal,Backbone);;
(function(Backbone,Drupal){Drupal.quickedit.AppModel=Backbone.Model.extend({defaults:{highlightedField:null,activeField:null,activeModal:null}});})(Backbone,Drupal);;
(function(_,$,Backbone,Drupal){Drupal.quickedit.EntityModel=Drupal.quickedit.BaseModel.extend({defaults:{el:null,entityID:null,entityInstanceID:null,id:null,label:null,fields:null,isActive:false,inTempStore:false,isDirty:false,isCommitting:false,state:'closed',fieldsInTempStore:[],reload:false},initialize:function initialize(){this.set('fields',new Drupal.quickedit.FieldCollection());this.listenTo(this,'change:state',this.stateChange);this.listenTo(this.get('fields'),'change:state',this.fieldStateChange);Drupal.quickedit.BaseModel.prototype.initialize.call(this);},stateChange:function stateChange(entityModel,state,options){var to=state;switch(to){case 'closed':this.set({isActive:false,inTempStore:false,isDirty:false});break;case 'launching':break;case 'opening':entityModel.get('fields').each(function(fieldModel){fieldModel.set('state','candidate',options);});break;case 'opened':this.set('isActive',true);break;case 'committing':var fields=this.get('fields');fields.chain().filter(function(fieldModel){return _.intersection([fieldModel.get('state')],['active']).length;}).each(function(fieldModel){fieldModel.set('state','candidate');});fields.chain().filter(function(fieldModel){return _.intersection([fieldModel.get('state')],Drupal.quickedit.app.changedFieldStates).length;}).each(function(fieldModel){fieldModel.set('state','saving');});break;case 'deactivating':var changedFields=this.get('fields').filter(function(fieldModel){return _.intersection([fieldModel.get('state')],['changed','invalid']).length;});if((changedFields.length||this.get('fieldsInTempStore').length)&&!options.saved&&!options.confirmed){this.set('state','opened',{confirming:true});_.defer(function(){Drupal.quickedit.app.confirmEntityDeactivation(entityModel);});}else{var invalidFields=this.get('fields').filter(function(fieldModel){return _.intersection([fieldModel.get('state')],['invalid']).length;});entityModel.set('reload',this.get('fieldsInTempStore').length||invalidFields.length);entityModel.get('fields').each(function(fieldModel){if(_.intersection([fieldModel.get('state')],['candidate','highlighted']).length)fieldModel.trigger('change:state',fieldModel,fieldModel.get('state'),options);else fieldModel.set('state','candidate',options);});}break;case 'closing':options.reason='stop';this.get('fields').each(function(fieldModel){fieldModel.set({inTempStore:false,state:'inactive'},options);});break;}},_updateInTempStoreAttributes:function _updateInTempStoreAttributes(entityModel,fieldModel){var current=fieldModel.get('state');var previous=fieldModel.previous('state');var fieldsInTempStore=entityModel.get('fieldsInTempStore');if(current==='saved'){entityModel.set('inTempStore',true);fieldModel.set('inTempStore',true);fieldsInTempStore.push(fieldModel.get('fieldID'));fieldsInTempStore=_.uniq(fieldsInTempStore);entityModel.set('fieldsInTempStore',fieldsInTempStore);}else{if(current==='candidate'&&previous==='inactive')fieldModel.set('inTempStore',_.intersection([fieldModel.get('fieldID')],fieldsInTempStore).length>0);}},fieldStateChange:function fieldStateChange(fieldModel,state){var entityModel=this;var fieldState=state;switch(this.get('state')){case 'closed':case 'launching':break;case 'opening':_.defer(function(){entityModel.set('state','opened',{'accept-field-states':Drupal.quickedit.app.readyFieldStates});});break;case 'opened':if(fieldState==='changed')entityModel.set('isDirty',true);else this._updateInTempStoreAttributes(entityModel,fieldModel);break;case 'committing':if(fieldState==='invalid')_.defer(function(){entityModel.set('state','opened',{reason:'invalid'});});else this._updateInTempStoreAttributes(entityModel,fieldModel);var options={'accept-field-states':Drupal.quickedit.app.readyFieldStates};if(entityModel.set('isCommitting',true,options))entityModel.save({success:function success(){entityModel.set({state:'deactivating',isCommitting:false},{saved:true});},error:function error(){entityModel.set('isCommitting',false);entityModel.set('state','opened',{reason:'networkerror'});var message=Drupal.t('Your changes to <q>@entity-title</q> could not be saved, either due to a website problem or a network connection problem.<br>Please try again.',{'@entity-title':entityModel.get('label')});Drupal.quickedit.util.networkErrorModal(Drupal.t('Network problem!'),message);}});break;case 'deactivating':_.defer(function(){entityModel.set('state','closing',{'accept-field-states':Drupal.quickedit.app.readyFieldStates});});break;case 'closing':_.defer(function(){entityModel.set('state','closed',{'accept-field-states':['inactive']});});break;}},save:function save(options){var entityModel=this;var entitySaverAjax=Drupal.ajax({url:Drupal.url("quickedit/entity/".concat(entityModel.get('entityID'))),error:function error(){options.error.call(entityModel);}});entitySaverAjax.commands.quickeditEntitySaved=function(ajax,response,status){entityModel.get('fields').each(function(fieldModel){fieldModel.set('inTempStore',false);});entityModel.set('inTempStore',false);entityModel.set('fieldsInTempStore',[]);if(options.success)options.success.call(entityModel);};entitySaverAjax.options.headers=entitySaverAjax.options.headers||{};entitySaverAjax.options.headers['X-Drupal-Quickedit-CSRF-Token']=drupalSettings.quickedit.csrf_token;entitySaverAjax.execute();},validate:function validate(attrs,options){var acceptedFieldStates=options['accept-field-states']||[];var currentState=this.get('state');var nextState=attrs.state;if(currentState!==nextState){if(_.indexOf(this.constructor.states,nextState)===-1)return "\"".concat(nextState,"\" is an invalid state");if(!this._acceptStateChange(currentState,nextState,options))return 'state change not accepted';if(!this._fieldsHaveAcceptableStates(acceptedFieldStates))return 'state change not accepted because fields are not in acceptable state';}var currentIsCommitting=this.get('isCommitting');var nextIsCommitting=attrs.isCommitting;if(currentIsCommitting===false&&nextIsCommitting===true){if(!this._fieldsHaveAcceptableStates(acceptedFieldStates))return 'isCommitting change not accepted because fields are not in acceptable state';}else{if(currentIsCommitting===true&&nextIsCommitting===true)return 'isCommitting is a mutex, hence only changes are allowed';}},_acceptStateChange:function _acceptStateChange(from,to,context){var accept=true;if(!this.constructor.followsStateSequence(from,to)){accept=false;if(from==='closing'&&to==='closed')accept=true;else if(from==='committing'&&to==='opened'&&context.reason&&(context.reason==='invalid'||context.reason==='networkerror'))accept=true;else if(from==='deactivating'&&to==='opened'&&context.confirming)accept=true;else{if(from==='opened'&&to==='deactivating'&&context.confirmed)accept=true;}}return accept;},_fieldsHaveAcceptableStates:function _fieldsHaveAcceptableStates(acceptedFieldStates){var accept=true;if(acceptedFieldStates.length>0){var fieldStates=this.get('fields').pluck('state')||[];if(_.difference(fieldStates,acceptedFieldStates).length)accept=false;}return accept;},destroy:function destroy(options){Drupal.quickedit.BaseModel.prototype.destroy.call(this,options);this.stopListening();this.get('fields').reset();},sync:function sync(){}},{states:['closed','launching','opening','opened','committing','deactivating','closing'],followsStateSequence:function followsStateSequence(from,to){return _.indexOf(this.states,from)<_.indexOf(this.states,to);}});Drupal.quickedit.EntityCollection=Backbone.Collection.extend({model:Drupal.quickedit.EntityModel});})(_,jQuery,Backbone,Drupal);;
(function(_,Backbone,Drupal){Drupal.quickedit.FieldModel=Drupal.quickedit.BaseModel.extend({defaults:{el:null,fieldID:null,id:null,entity:null,metadata:null,acceptStateChange:null,logicalFieldID:null,state:'inactive',isChanged:false,inTempStore:false,html:null,htmlForOtherViewModes:null},initialize:function initialize(options){this.set('html',options.el.outerHTML);this.get('entity').get('fields').add(this);this.set('logicalFieldID',this.get('fieldID').split('/').slice(0,4).join('/'));Drupal.quickedit.BaseModel.prototype.initialize.call(this,options);},destroy:function destroy(options){if(this.get('state')!=='inactive')throw new Error('FieldModel cannot be destroyed if it is not inactive state.');Drupal.quickedit.BaseModel.prototype.destroy.call(this,options);},sync:function sync(){},validate:function validate(attrs,options){var current=this.get('state');var next=attrs.state;if(current!==next){if(_.indexOf(this.constructor.states,next)===-1)return "\"".concat(next,"\" is an invalid state");if(!this.get('acceptStateChange')(current,next,options,this))return 'state change not accepted';}},getEntityID:function getEntityID(){return this.get('fieldID').split('/').slice(0,2).join('/');},getViewMode:function getViewMode(){return this.get('fieldID').split('/').pop();},findOtherViewModes:function findOtherViewModes(){var currentField=this;var otherViewModes=[];Drupal.quickedit.collections.fields.where({logicalFieldID:currentField.get('logicalFieldID')}).forEach(function(field){if(field!==currentField&&field.get('fieldID')!==currentField.get('fieldID'))otherViewModes.push(field.getViewMode());});return otherViewModes;}},{states:['inactive','candidate','highlighted','activating','active','changed','saving','saved','invalid'],followsStateSequence:function followsStateSequence(from,to){return _.indexOf(this.states,from)<_.indexOf(this.states,to);}});Drupal.quickedit.FieldCollection=Backbone.Collection.extend({model:Drupal.quickedit.FieldModel});})(_,Backbone,Drupal);;
(function(Backbone,Drupal){Drupal.quickedit.EditorModel=Backbone.Model.extend({defaults:{originalValue:null,currentValue:null,validationErrors:null}});})(Backbone,Drupal);;
(function($,_,Backbone,Drupal){var reload=false;Drupal.quickedit.AppView=Backbone.View.extend({initialize:function initialize(options){this.activeFieldStates=['activating','active'];this.singleFieldStates=['highlighted','activating','active'];this.changedFieldStates=['changed','saving','saved','invalid'];this.readyFieldStates=['candidate','highlighted'];this.listenTo(options.entitiesCollection,'change:state',this.appStateChange);this.listenTo(options.entitiesCollection,'change:isActive',this.enforceSingleActiveEntity);this.listenTo(options.fieldsCollection,'change:state',this.editorStateChange);this.listenTo(options.fieldsCollection,'change:html',this.renderUpdatedField);this.listenTo(options.fieldsCollection,'change:html',this.propagateUpdatedField);this.listenTo(options.fieldsCollection,'add',this.rerenderedFieldToCandidate);this.listenTo(options.fieldsCollection,'destroy',this.teardownEditor);},appStateChange:function appStateChange(entityModel,state){var app=this;var entityToolbarView;switch(state){case 'launching':reload=false;entityToolbarView=new Drupal.quickedit.EntityToolbarView({model:entityModel,appModel:this.model});entityModel.toolbarView=entityToolbarView;entityModel.get('fields').each(function(fieldModel){app.setupEditor(fieldModel);});_.defer(function(){entityModel.set('state','opening');});break;case 'closed':entityToolbarView=entityModel.toolbarView;entityModel.get('fields').each(function(fieldModel){app.teardownEditor(fieldModel);});if(entityToolbarView){entityToolbarView.remove();delete entityModel.toolbarView;}if(reload){reload=false;window.location.reload();}break;}},acceptEditorStateChange:function acceptEditorStateChange(from,to,context,fieldModel){var accept=true;if(context&&(context.reason==='stop'||context.reason==='rerender')){if(from==='candidate'&&to==='inactive')accept=true;}else{if(!Drupal.quickedit.FieldModel.followsStateSequence(from,to)){accept=false;if(_.indexOf(this.activeFieldStates,from)!==-1&&to==='candidate')accept=true;else if((from==='changed'||from==='invalid')&&to==='candidate')accept=true;else if(from==='highlighted'&&to==='candidate')accept=true;else if(from==='saved'&&to==='candidate')accept=true;else if(from==='invalid'&&to==='saving')accept=true;else{if(from==='invalid'&&to==='activating')accept=true;}}if(accept){var activeField;var activeFieldState;if((this.readyFieldStates.indexOf(from)!==-1||from==='invalid')&&this.activeFieldStates.indexOf(to)!==-1){activeField=this.model.get('activeField');if(activeField&&activeField!==fieldModel){activeFieldState=activeField.get('state');if(this.activeFieldStates.indexOf(activeFieldState)!==-1)activeField.set('state','candidate');else{if(activeFieldState==='changed'||activeFieldState==='invalid')activeField.set('state','saving');}if(from==='invalid'){this.model.set('activeField',fieldModel);accept=false;}}}else if(_.indexOf(this.activeFieldStates,from)!==-1&&to==='candidate'){if(context&&context.reason==='mouseleave')accept=false;}else{if((from==='changed'||from==='invalid')&&to==='candidate')if(context&&context.reason==='mouseleave')accept=false;else{if(context&&context.confirmed)accept=true;}}}}return accept;},setupEditor:function setupEditor(fieldModel){var entityModel=fieldModel.get('entity');var entityToolbarView=entityModel.toolbarView;var fieldToolbarRoot=entityToolbarView.getToolbarRoot();var editorName=fieldModel.get('metadata').editor;var editorModel=new Drupal.quickedit.EditorModel();var editorView=new Drupal.quickedit.editors[editorName]({el:$(fieldModel.get('el')),model:editorModel,fieldModel});var toolbarView=new Drupal.quickedit.FieldToolbarView({el:fieldToolbarRoot,model:fieldModel,$editedElement:$(editorView.getEditedElement()),editorView,entityModel});var decorationView=new Drupal.quickedit.FieldDecorationView({el:$(editorView.getEditedElement()),model:fieldModel,editorView});fieldModel.editorView=editorView;fieldModel.toolbarView=toolbarView;fieldModel.decorationView=decorationView;},teardownEditor:function teardownEditor(fieldModel){if(typeof fieldModel.editorView==='undefined')return;fieldModel.toolbarView.remove();delete fieldModel.toolbarView;fieldModel.decorationView.remove();delete fieldModel.decorationView;fieldModel.editorView.remove();delete fieldModel.editorView;},confirmEntityDeactivation:function confirmEntityDeactivation(entityModel){var that=this;var discardDialog;function closeDiscardDialog(action){discardDialog.close(action);that.model.set('activeModal',null);if(action==='save')entityModel.set('state','committing',{confirmed:true});else{entityModel.set('state','deactivating',{confirmed:true});if(entityModel.get('reload')){reload=true;entityModel.set('reload',false);}}}if(!this.model.get('activeModal')){var $unsavedChanges=$("<div>".concat(Drupal.t('You have unsaved changes'),"</div>"));discardDialog=Drupal.dialog($unsavedChanges.get(0),{title:Drupal.t('Discard changes?'),dialogClass:'quickedit-discard-modal',resizable:false,buttons:[{text:Drupal.t('Save'),click:function click(){closeDiscardDialog('save');},primary:true},{text:Drupal.t('Discard changes'),click:function click(){closeDiscardDialog('discard');}}],closeOnEscape:false,create:function create(){$(this).parent().find('.ui-dialog-titlebar-close').remove();},beforeClose:false,close:function close(event){$(event.target).remove();}});this.model.set('activeModal',discardDialog);discardDialog.showModal();}},editorStateChange:function editorStateChange(fieldModel,state){var from=fieldModel.previous('state');var to=state;if(_.indexOf(this.singleFieldStates,to)!==-1&&this.model.get('highlightedField')!==fieldModel)this.model.set('highlightedField',fieldModel);else{if(this.model.get('highlightedField')===fieldModel&&to==='candidate')this.model.set('highlightedField',null);}if(_.indexOf(this.activeFieldStates,to)!==-1&&this.model.get('activeField')!==fieldModel)this.model.set('activeField',fieldModel);else{if(this.model.get('activeField')===fieldModel&&to==='candidate'){if(from==='changed'||from==='invalid')fieldModel.editorView.revert();this.model.set('activeField',null);}}},renderUpdatedField:function renderUpdatedField(fieldModel,html,options){var $fieldWrapper=$(fieldModel.get('el'));var $context=$fieldWrapper.parent();var renderField=function renderField(){fieldModel.destroy();$fieldWrapper.replaceWith(html);Drupal.attachBehaviors($context.get(0));};if(!options.propagation)_.defer(function(){fieldModel.set('state','candidate');_.defer(function(){fieldModel.set('state','inactive',{reason:'rerender'});renderField();});});else renderField();},propagateUpdatedField:function propagateUpdatedField(updatedField,html,options){if(options.propagation)return;var htmlForOtherViewModes=updatedField.get('htmlForOtherViewModes');Drupal.quickedit.collections.fields.where({logicalFieldID:updatedField.get('logicalFieldID')}).forEach(function(field){if(field===updatedField){}else if(field.getViewMode()===updatedField.getViewMode())field.set('html',updatedField.get('html'));else{if(field.getViewMode() in htmlForOtherViewModes)field.set('html',htmlForOtherViewModes[field.getViewMode()],{propagation:true});}});},rerenderedFieldToCandidate:function rerenderedFieldToCandidate(fieldModel){var activeEntity=Drupal.quickedit.collections.entities.findWhere({isActive:true});if(!activeEntity)return;if(fieldModel.get('entity')===activeEntity){this.setupEditor(fieldModel);fieldModel.set('state','candidate');}},enforceSingleActiveEntity:function enforceSingleActiveEntity(changedEntityModel){if(changedEntityModel.get('isActive')===false)return;changedEntityModel.collection.chain().filter(function(entityModel){return entityModel.get('isActive')===true&&entityModel!==changedEntityModel;}).each(function(entityModel){entityModel.set('state','deactivating');});}});})(jQuery,_,Backbone,Drupal);;
(function($,Backbone,Drupal){Drupal.quickedit.FieldDecorationView=Backbone.View.extend({_widthAttributeIsEmpty:null,events:{'mouseenter.quickedit':'onMouseEnter','mouseleave.quickedit':'onMouseLeave',click:'onClick','tabIn.quickedit':'onMouseEnter','tabOut.quickedit':'onMouseLeave'},initialize:function initialize(options){this.editorView=options.editorView;this.listenTo(this.model,'change:state',this.stateChange);this.listenTo(this.model,'change:isChanged change:inTempStore',this.renderChanged);},remove:function remove(){this.setElement();Backbone.View.prototype.remove.call(this);},stateChange:function stateChange(model,state){var from=model.previous('state');var to=state;switch(to){case 'inactive':this.undecorate();break;case 'candidate':this.decorate();if(from!=='inactive'){this.stopHighlight();if(from!=='highlighted'){this.model.set('isChanged',false);this.stopEdit();}}this._unpad();break;case 'highlighted':this.startHighlight();break;case 'activating':this.prepareEdit();break;case 'active':if(from!=='activating')this.prepareEdit();if(this.editorView.getQuickEditUISettings().padding)this._pad();break;case 'changed':this.model.set('isChanged',true);break;case 'saving':break;case 'saved':break;case 'invalid':break;}},renderChanged:function renderChanged(){this.$el.toggleClass('quickedit-changed',this.model.get('isChanged')||this.model.get('inTempStore'));},onMouseEnter:function onMouseEnter(event){var that=this;that.model.set('state','highlighted');event.stopPropagation();},onMouseLeave:function onMouseLeave(event){var that=this;that.model.set('state','candidate',{reason:'mouseleave'});event.stopPropagation();},onClick:function onClick(event){this.model.set('state','activating');event.preventDefault();event.stopPropagation();},decorate:function decorate(){this.$el.addClass('quickedit-candidate quickedit-editable');},undecorate:function undecorate(){this.$el.removeClass('quickedit-candidate quickedit-editable quickedit-highlighted quickedit-editing');},startHighlight:function startHighlight(){var that=this;that.$el.addClass('quickedit-highlighted');},stopHighlight:function stopHighlight(){this.$el.removeClass('quickedit-highlighted');},prepareEdit:function prepareEdit(){this.$el.addClass('quickedit-editing');if(this.editorView.getQuickEditUISettings().popup)this.$el.addClass('quickedit-editor-is-popup');},stopEdit:function stopEdit(){this.$el.removeClass('quickedit-highlighted quickedit-editing');if(this.editorView.getQuickEditUISettings().popup)this.$el.removeClass('quickedit-editor-is-popup');$('.quickedit-candidate').addClass('quickedit-editable');},_pad:function _pad(){if(this.$el.data('quickedit-padded'))return;var self=this;if(this.$el[0].style.width===''){this._widthAttributeIsEmpty=true;this.$el.addClass('quickedit-animate-disable-width').css('width',this.$el.width());}var posProp=this._getPositionProperties(this.$el);setTimeout(function(){self.$el.removeClass('quickedit-animate-disable-width');self.$el.css({position:'relative',top:"".concat(posProp.top-5,"px"),left:"".concat(posProp.left-5,"px"),'padding-top':"".concat(posProp['padding-top']+5,"px"),'padding-left':"".concat(posProp['padding-left']+5,"px"),'padding-right':"".concat(posProp['padding-right']+5,"px"),'padding-bottom':"".concat(posProp['padding-bottom']+5,"px"),'margin-bottom':"".concat(posProp['margin-bottom']-10,"px")}).data('quickedit-padded',true);},0);},_unpad:function _unpad(){if(!this.$el.data('quickedit-padded'))return;var self=this;if(this._widthAttributeIsEmpty)this.$el.addClass('quickedit-animate-disable-width').css('width','');var posProp=this._getPositionProperties(this.$el);setTimeout(function(){self.$el.removeClass('quickedit-animate-disable-width');self.$el.css({position:'relative',top:"".concat(posProp.top+5,"px"),left:"".concat(posProp.left+5,"px"),'padding-top':"".concat(posProp['padding-top']-5,"px"),'padding-left':"".concat(posProp['padding-left']-5,"px"),'padding-right':"".concat(posProp['padding-right']-5,"px"),'padding-bottom':"".concat(posProp['padding-bottom']-5,"px"),'margin-bottom':"".concat(posProp['margin-bottom']+10,"px")});},0);this.$el.removeData('quickedit-padded');},_getPositionProperties:function _getPositionProperties($e){var p;var r={};var props=['top','left','bottom','right','padding-top','padding-left','padding-right','padding-bottom','margin-bottom'];var propCount=props.length;for(var i=0;i<propCount;i++){p=props[i];r[p]=parseInt(this._replaceBlankPosition($e.css(p)),10);}return r;},_replaceBlankPosition:function _replaceBlankPosition(pos){if(pos==='auto'||!pos)pos='0px';return pos;}});})(jQuery,Backbone,Drupal);;
(function(Drupal,$,Backbone){Drupal.quickedit.EntityDecorationView=Backbone.View.extend({initialize:function initialize(){this.listenTo(this.model,'change',this.render);},render:function render(){this.$el.toggleClass('quickedit-entity-active',this.model.get('isActive'));},remove:function remove(){this.setElement(null);Backbone.View.prototype.remove.call(this);}});})(Drupal,jQuery,Backbone);;
(function($,_,Backbone,Drupal,debounce,Popper){Drupal.quickedit.EntityToolbarView=Backbone.View.extend({_fieldToolbarRoot:null,events:function events(){var map={'click button.action-save':'onClickSave','click button.action-cancel':'onClickCancel',mouseenter:'onMouseenter'};return map;},initialize:function initialize(options){var that=this;this.appModel=options.appModel;this.$entity=$(this.model.get('el'));this.listenTo(this.model,'change:isActive change:isDirty change:state',this.render);this.listenTo(this.appModel,'change:highlightedField change:activeField',this.render);this.listenTo(this.model.get('fields'),'change:state',this.fieldStateChange);$(window).on('resize.quickedit scroll.quickedit drupalViewportOffsetChange.quickedit',debounce($.proxy(this.windowChangeHandler,this),150));$(document).on('drupalViewportOffsetChange.quickedit',function(event,offsets){if(that.$fence)that.$fence.css(offsets);});var $toolbar=this.buildToolbarEl();this.setElement($toolbar);this._fieldToolbarRoot=$toolbar.find('.quickedit-toolbar-field').get(0);this.render();},render:function render(){if(this.model.get('isActive')){var $body=$('body');if($body.children('#quickedit-entity-toolbar').length===0)$body.append(this.$el);if($body.children('#quickedit-toolbar-fence').length===0)this.$fence=$(Drupal.theme('quickeditEntityToolbarFence')).css(Drupal.displace()).appendTo($body);this.label();this.show('ops');this.position();}var $button=this.$el.find('.quickedit-button.action-save');var isDirty=this.model.get('isDirty');switch(this.model.get('state')){case 'opened':$button[0].textContent=Drupal.t('Save');$button.removeClass('action-saving icon-throbber icon-end').removeAttr('disabled').attr('aria-hidden',!isDirty);break;case 'committing':$button[0].textContent=Drupal.t('Saving');$button.addClass('action-saving icon-throbber icon-end').attr('disabled','disabled');break;default:$button.attr('aria-hidden',true);break;}return this;},remove:function remove(){this.$fence.remove();$(window).off('resize.quickedit scroll.quickedit drupalViewportOffsetChange.quickedit');$(document).off('drupalViewportOffsetChange.quickedit');Backbone.View.prototype.remove.call(this);},windowChangeHandler:function windowChangeHandler(event){this.position();},fieldStateChange:function fieldStateChange(model,state){switch(state){case 'active':this.render();break;case 'invalid':this.render();break;}},position:function position(element){clearTimeout(this.timer);var that=this;var edge=document.documentElement.dir==='rtl'?'right':'left';var delay=0;var check=0;var horizontalPadding=0;var of;var activeField;var highlightedField;do{switch(check){case 0:of=element;break;case 1:activeField=Drupal.quickedit.app.model.get('activeField');of=activeField&&activeField.editorView&&activeField.editorView.$formContainer&&activeField.editorView.$formContainer.find('.quickedit-form');break;case 2:of=activeField&&activeField.editorView&&activeField.editorView.getEditedElement();if(activeField&&activeField.editorView&&activeField.editorView.getQuickEditUISettings().padding)horizontalPadding=5;break;case 3:highlightedField=Drupal.quickedit.app.model.get('highlightedField');of=highlightedField&&highlightedField.editorView&&highlightedField.editorView.getEditedElement();delay=250;break;default:var fieldModels=this.model.get('fields').models;var topMostPosition=1000000;var topMostField=null;for(var i=0;i<fieldModels.length;i++){var pos=fieldModels[i].get('el').getBoundingClientRect().top;if(pos<topMostPosition){topMostPosition=pos;topMostField=fieldModels[i];}}of=topMostField.get('el');delay=50;break;}check++;}while(!of);function refinePopper(_ref){var state=_ref.state;var isBelow=state.placement.split('-')[0]==='bottom';var classListMethod=isBelow?'add':'remove';state.elements.popper.classList[classListMethod]('quickedit-toolbar-pointer-top');}function positionToolbar(){var popperElement=that.el;var referenceElement=of;var boundariesElement=that.$fence[0];var popperedge=edge==='left'?'start':'end';if(referenceElement!==undefined)if(!popperElement.classList.contains('js-popper-processed')){that.popper=Popper.createPopper(referenceElement,popperElement,{placement:"top-".concat(popperedge),modifiers:[{name:'flip',options:{boundary:boundariesElement}},{name:'preventOverflow',options:{boundary:boundariesElement,tether:false,altAxis:true,padding:{top:5,bottom:5}}},{name:'computeStyles',options:{adaptive:false}},{name:'refinePopper',phase:'write',enabled:true,fn:refinePopper}]});popperElement.classList.add('js-popper-processed');}else{that.popper.state.elements.reference=referenceElement[0]?referenceElement[0]:referenceElement;that.popper.forceUpdate();}that.$el.css({'max-width':document.documentElement.clientWidth<450?document.documentElement.clientWidth:450,'min-width':document.documentElement.clientWidth<240?document.documentElement.clientWidth:240,width:'100%'});}this.timer=setTimeout(function(){_.defer(positionToolbar);},delay);},onClickSave:function onClickSave(event){event.stopPropagation();event.preventDefault();this.model.set('state','committing');},onClickCancel:function onClickCancel(event){event.preventDefault();this.model.set('state','deactivating');},onMouseenter:function onMouseenter(event){clearTimeout(this.timer);},buildToolbarEl:function buildToolbarEl(){var $toolbar=$(Drupal.theme('quickeditEntityToolbar',{id:'quickedit-entity-toolbar'}));$toolbar.find('.quickedit-toolbar-entity').prepend(Drupal.theme('quickeditToolgroup',{classes:['ops'],buttons:[{label:Drupal.t('Save'),type:'submit',classes:'action-save quickedit-button icon',attributes:{'aria-hidden':true}},{label:Drupal.t('Close'),classes:'action-cancel quickedit-button icon icon-close icon-only'}]}));$toolbar.css({left:this.$entity.offset().left,top:this.$entity.offset().top});return $toolbar;},getToolbarRoot:function getToolbarRoot(){return this._fieldToolbarRoot;},label:function label(){var label='';var entityLabel=this.model.get('label');var activeField=Drupal.quickedit.app.model.get('activeField');var activeFieldLabel=activeField&&activeField.get('metadata').label;var highlightedField=Drupal.quickedit.app.model.get('highlightedField');var highlightedFieldLabel=highlightedField&&highlightedField.get('metadata').label;if(activeFieldLabel)label=Drupal.theme('quickeditEntityToolbarLabel',{entityLabel,fieldLabel:activeFieldLabel});else if(highlightedFieldLabel)label=Drupal.theme('quickeditEntityToolbarLabel',{entityLabel,fieldLabel:highlightedFieldLabel});else label=Drupal.checkPlain(entityLabel);this.$el.find('.quickedit-toolbar-label').html(label);},addClass:function addClass(toolgroup,classes){this._find(toolgroup).addClass(classes);},removeClass:function removeClass(toolgroup,classes){this._find(toolgroup).removeClass(classes);},_find:function _find(toolgroup){return this.$el.find(".quickedit-toolbar .quickedit-toolgroup.".concat(toolgroup));},show:function show(toolgroup){this.$el.removeClass('quickedit-animate-invisible');}});})(jQuery,_,Backbone,Drupal,Drupal.debounce,Popper);;
(function($,Backbone,Drupal){Drupal.quickedit.ContextualLinkView=Backbone.View.extend({events:function events(){function touchEndToClick(event){event.preventDefault();event.target.click();}return {'click a':function clickA(event){event.preventDefault();this.model.set('state','launching');},'touchEnd a':touchEndToClick};},initialize:function initialize(options){this.$el.find('a').each(function(index,element){element.textContent=options.strings.quickEdit;});this.render();this.listenTo(this.model,'change:isActive',this.render);},render:function render(entityModel,isActive){this.$el.find('a').attr('aria-pressed',isActive);this.$el.closest('.contextual').toggle(!isActive);return this;}});})(jQuery,Backbone,Drupal);;
(function($,_,Backbone,Drupal){Drupal.quickedit.FieldToolbarView=Backbone.View.extend({$editedElement:null,editorView:null,_id:null,initialize:function initialize(options){this.$editedElement=options.$editedElement;this.editorView=options.editorView;this.$root=this.$el;this._id="quickedit-toolbar-for-".concat(this.model.id.replace(/[/[\]]/g,'_'));this.listenTo(this.model,'change:state',this.stateChange);},render:function render(){this.setElement($(Drupal.theme('quickeditFieldToolbar',{id:this._id})));this.$el.prependTo(this.$root);return this;},stateChange:function stateChange(model,state){var from=model.previous('state');var to=state;switch(to){case 'inactive':break;case 'candidate':if(from!=='inactive'&&from!=='highlighted'){this.$el.remove();this.setElement();}break;case 'highlighted':break;case 'activating':this.render();if(this.editorView.getQuickEditUISettings().fullWidthToolbar)this.$el.addClass('quickedit-toolbar-fullwidth');if(this.editorView.getQuickEditUISettings().unifiedToolbar)this.insertWYSIWYGToolGroups();break;case 'active':break;case 'changed':break;case 'saving':break;case 'saved':break;case 'invalid':break;}},insertWYSIWYGToolGroups:function insertWYSIWYGToolGroups(){this.$el.append(Drupal.theme('quickeditToolgroup',{id:this.getFloatedWysiwygToolgroupId(),classes:['wysiwyg-floated','quickedit-animate-slow','quickedit-animate-invisible','quickedit-animate-delay-veryfast'],buttons:[]})).append(Drupal.theme('quickeditToolgroup',{id:this.getMainWysiwygToolgroupId(),classes:['wysiwyg-main','quickedit-animate-slow','quickedit-animate-invisible','quickedit-animate-delay-veryfast'],buttons:[]}));this.show('wysiwyg-floated');this.show('wysiwyg-main');},getId:function getId(){return "quickedit-toolbar-for-".concat(this._id);},getFloatedWysiwygToolgroupId:function getFloatedWysiwygToolgroupId(){return "quickedit-wysiwyg-floated-toolgroup-for-".concat(this._id);},getMainWysiwygToolgroupId:function getMainWysiwygToolgroupId(){return "quickedit-wysiwyg-main-toolgroup-for-".concat(this._id);},_find:function _find(toolgroup){return this.$el.find(".quickedit-toolgroup.".concat(toolgroup));},show:function show(toolgroup){var $group=this._find(toolgroup);$group.on(Drupal.quickedit.util.constants.transitionEnd,function(event){$group.off(Drupal.quickedit.util.constants.transitionEnd);});window.setTimeout(function(){$group.removeClass('quickedit-animate-invisible');},0);}});})(jQuery,_,Backbone,Drupal);;
(function($,Backbone,Drupal){Drupal.quickedit.EditorView=Backbone.View.extend({initialize:function initialize(options){this.fieldModel=options.fieldModel;this.listenTo(this.fieldModel,'change:state',this.stateChange);},remove:function remove(){this.setElement();Backbone.View.prototype.remove.call(this);},getEditedElement:function getEditedElement(){return this.$el;},getQuickEditUISettings:function getQuickEditUISettings(){return {padding:false,unifiedToolbar:false,fullWidthToolbar:false,popup:false};},stateChange:function stateChange(fieldModel,state){var from=fieldModel.previous('state');var to=state;switch(to){case 'inactive':break;case 'candidate':if(from==='invalid')this.removeValidationErrors();break;case 'highlighted':break;case 'activating':var loadDependencies=function loadDependencies(callback){callback();};loadDependencies(function(){fieldModel.set('state','active');});break;case 'active':break;case 'changed':break;case 'saving':if(from==='invalid')this.removeValidationErrors();this.save();break;case 'saved':break;case 'invalid':this.showValidationErrors();break;}},revert:function revert(){},save:function save(){var fieldModel=this.fieldModel;var editorModel=this.model;var backstageId="quickedit_backstage-".concat(this.fieldModel.id.replace(/[/[\]_\s]/g,'-'));function fillAndSubmitForm(value){var $form=$("#".concat(backstageId)).find('form');$form.find(':input[type!="hidden"][type!="submit"]:not(select)').not('[name$="\\[summary\\]"]').val(value);$form.find('.quickedit-form-submit').trigger('click.quickedit');}var formOptions={fieldID:this.fieldModel.get('fieldID'),$el:this.$el,nocssjs:true,other_view_modes:fieldModel.findOtherViewModes(),reset:!this.fieldModel.get('entity').get('inTempStore')};var self=this;Drupal.quickedit.util.form.load(formOptions,function(form,ajax){var $backstage=$(Drupal.theme('quickeditBackstage',{id:backstageId})).appendTo('body');var $form=$(form).appendTo($backstage);$form.prop('novalidate',true);var $submit=$form.find('.quickedit-form-submit');self.formSaveAjax=Drupal.quickedit.util.form.ajaxifySaving(formOptions,$submit);function removeHiddenForm(){Drupal.quickedit.util.form.unajaxifySaving(self.formSaveAjax);delete self.formSaveAjax;$backstage.remove();}self.formSaveAjax.commands.quickeditFieldFormSaved=function(ajax,response,status){removeHiddenForm();fieldModel.set('state','saved');fieldModel.set('htmlForOtherViewModes',response.other_view_modes);fieldModel.set('html',response.data);};self.formSaveAjax.commands.quickeditFieldFormValidationErrors=function(ajax,response,status){removeHiddenForm();editorModel.set('validationErrors',response.data);fieldModel.set('state','invalid');};self.formSaveAjax.commands.quickeditFieldForm=function(){};fillAndSubmitForm(editorModel.get('currentValue'));});},showValidationErrors:function showValidationErrors(){var $errors=$('<div class="quickedit-validation-errors"></div>').append(this.model.get('validationErrors'));this.getEditedElement().addClass('quickedit-validation-error').after($errors);},removeValidationErrors:function removeValidationErrors(){this.getEditedElement().removeClass('quickedit-validation-error').next('.quickedit-validation-errors').remove();}});})(jQuery,Backbone,Drupal);;
(function($,Drupal){Drupal.theme.quickeditBackstage=function(settings){var html='';html+="<div id=\"".concat(settings.id,"\"></div>");return html;};Drupal.theme.quickeditEntityToolbar=function(settings){var html='';html+="<div id=\"".concat(settings.id,"\" class=\"quickedit quickedit-toolbar-container clearfix\">");html+='<i class="quickedit-toolbar-pointer"></i>';html+='<div class="quickedit-toolbar-content">';html+='<div class="quickedit-toolbar quickedit-toolbar-entity clearfix icon icon-pencil">';html+='<div class="quickedit-toolbar-label"></div>';html+='</div>';html+='<div class="quickedit-toolbar quickedit-toolbar-field clearfix"></div>';html+='</div><div class="quickedit-toolbar-lining"></div></div>';return html;};Drupal.theme.quickeditEntityToolbarLabel=function(settings){return "<span class=\"field\">".concat(Drupal.checkPlain(settings.fieldLabel),"</span>").concat(Drupal.checkPlain(settings.entityLabel));};Drupal.theme.quickeditEntityToolbarFence=function(){return '<div id="quickedit-toolbar-fence"></div>';};Drupal.theme.quickeditFieldToolbar=function(settings){return "<div id=\"".concat(settings.id,"\"></div>");};Drupal.theme.quickeditToolgroup=function(settings){var classes=settings.classes||[];classes.unshift('quickedit-toolgroup');var html='';html+="<div class=\"".concat(classes.join(' '),"\"");if(settings.id)html+=" id=\"".concat(settings.id,"\"");html+='>';html+=Drupal.theme('quickeditButtons',{buttons:settings.buttons});html+='</div>';return html;};Drupal.theme.quickeditButtons=function(settings){var html='';var _loop=function _loop(i){var button=settings.buttons[i];if(!button.hasOwnProperty('type'))button.type='button';var attributes=[];var attrMap=settings.buttons[i].attributes||{};Object.keys(attrMap).forEach(function(attr){attributes.push(attr+(attrMap[attr]?"=\"".concat(attrMap[attr],"\""):''));});html+="<button type=\"".concat(button.type,"\" class=\"").concat(button.classes,"\" ").concat(attributes.join(' '),">").concat(button.label,"</button>");};for(var i=0;i<settings.buttons.length;i++)_loop(i);return html;};Drupal.theme.quickeditFormContainer=function(settings){var html='';html+="<div id=\"".concat(settings.id,"\" class=\"quickedit-form-container\">");html+='  <div class="quickedit-form">';html+='    <div class="placeholder">';html+=settings.loadingMsg;html+='    </div>';html+='  </div>';html+='</div>';return html;};Drupal.theme.quickeditImageErrors=function(settings){return "<div class=\"quickedit-image-errors\">".concat(settings.errors,"</div>");};Drupal.theme.quickeditImageDropzone=function(settings){return "<div class=\"quickedit-image-dropzone ".concat(settings.state,"\">")+'  <i class="quickedit-image-icon"></i>'+"  <span class=\"quickedit-image-text\">".concat(settings.text,"</span>")+'</div>';};Drupal.theme.quickeditImageToolbar=function(settings){var html='<form class="quickedit-image-field-info">';if(settings.alt_field)html+="<div><label for=\"alt\" class=\"".concat(settings.alt_field_required?'required':'',"\">").concat(Drupal.t('Alternative text'),"</label>")+"<input type=\"text\" placeholder=\"".concat(settings.alt,"\" value=\"").concat(settings.alt,"\" name=\"alt\" ").concat(settings.alt_field_required?'required':'',"/>")+'  </div>';if(settings.title_field)html+="<div><label for=\"title\" class=\"".concat(settings.title_field_required?'form-required':'',"\">").concat(Drupal.t('Title'),"</label>")+"<input type=\"text\" placeholder=\"".concat(settings.title,"\" value=\"").concat(settings.title,"\" name=\"title\" ").concat(settings.title_field_required?'required':'',"/>")+'</div>';html+='</form>';return html;};})(jQuery,Drupal);;
(function($,Drupal){'use strict';var $triggered_times=0;var header_original_height=$('header').height();var lastScrollTop=0;var logoHeight=$('.logo svg').height();var originalLogoHeight=logoHeight;var scrolledLogoHeight=Math.round(logoHeight*0.6666667);var secondaryNavHeight=$('.secondary-navigation nav').outerHeight();$(window).on('load',function(){var secondaryHeaderHeight=$('.secondary-navigation').outerHeight();$('.secondary-navigation, .region-secondary-navigation').attr('style','height: '+secondaryHeaderHeight+'px;');$('body').subMenuFixed();$('body').logoSize();$('body').leftPosition();$('body').setActiveMenuItem();$('body').secondaryNav();$('body').menuColumns();$('body').quickLinks();$('body').searchForm();$('body').resetEybrowStuff();$('body').masonryGrid();$('body').fnfItem();$('body').gridItemHeight();$('body').equalHeightColumns();$('body').equalHeightSlides();$('body').initializeCarousel();$('body').menuScrollTop();$('body').eventFormat();$('body').alertMobile();$('body').alertControl();$('body').topOffset();$('body').offsiteLink();$('body').jumplink();$('body').closeMenus();$('body').populateSearch();$('body').blogTopicFilter();$('body').blogFeatureArticle();$('body').blogTopicBreadcrumbFix();$('video').prop("controls",true);});$(window).on('resize',function(){$('.secondary-navigation, .region-secondary-navigation').removeAttr('style').attr('style','height: '+$('.secondary-navigation').outerHeight()+'px;');$('body').resetEybrowStuff();$('body').equalHeightColumns();$('body').leftPosition();$('body').gridItemHeight();$('body').equalHeightSlides();$('body').alertMobile();$('body').alertControl();$('body').topOffset();});$(window).on('scroll',function(){$('body').logoSize();});$(document).on('keyup',function(evt){if(evt.keyCode==27)$.closeStuff();});$.fn.leftPosition=function(){$('body:not(.toolbar-tray-open) ul.nav > li.dropdown').each(function(){var thing=$(this);var offset=thing.offset();$(this).children('.dropdown-menu').css('padding-left',offset.left);});};$.fn.offsiteLink=function(){$('*:not(.nav.menu) a.offsite').each(function(){$(this).after("<svg width='16px' height='16px' viewBox='0 0 16 16' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><path d='M12.7807612,2.3 L10.45,2.3 C10.0910149,2.3 9.8,2.00898509 9.8,1.65 C9.8,1.29101491 10.0910149,1 10.45,1 L14.35,1 C14.7089851,1 15,1.29101491 15,1.65 L15,5.55 C15,5.90898509 14.7089851,6.2 14.35,6.2 C13.9910149,6.2 13.7,5.90898509 13.7,5.55 L13.7,3.21923882 L7.65961941,9.25961941 C7.40577862,9.5134602 6.99422138,9.5134602 6.74038059,9.25961941 C6.4865398,9.00577862 6.4865398,8.59422138 6.74038059,8.34038059 L12.7807612,2.3 Z M11.75,8.15 C11.75,7.79101491 12.0410149,7.5 12.4,7.5 C12.7589851,7.5 13.05,7.79101491 13.05,8.15 L13.05,12.05 C13.05,13.1269553 12.1769553,14 11.1,14 L3.95,14 C2.87304474,14 2,13.1269553 2,12.05 L2,4.9 C2,3.82304474 2.87304474,2.95 3.95,2.95 L7.85,2.95 C8.20898509,2.95 8.5,3.24101491 8.5,3.6 C8.5,3.95898509 8.20898509,4.25 7.85,4.25 L3.95,4.25 C3.59101491,4.25 3.3,4.54101491 3.3,4.9 L3.3,12.05 C3.3,12.4089851 3.59101491,12.7 3.95,12.7 L11.1,12.7 C11.4589851,12.7 11.75,12.4089851 11.75,12.05 L11.75,8.15 Z' fill='#005aa3'></path></svg>");});$('a.offsite-quick-link').each(function(){$(this).append("<svg width='16px' height='16px' viewBox='0 0 16 16' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><path d='M12.7807612,2.3 L10.45,2.3 C10.0910149,2.3 9.8,2.00898509 9.8,1.65 C9.8,1.29101491 10.0910149,1 10.45,1 L14.35,1 C14.7089851,1 15,1.29101491 15,1.65 L15,5.55 C15,5.90898509 14.7089851,6.2 14.35,6.2 C13.9910149,6.2 13.7,5.90898509 13.7,5.55 L13.7,3.21923882 L7.65961941,9.25961941 C7.40577862,9.5134602 6.99422138,9.5134602 6.74038059,9.25961941 C6.4865398,9.00577862 6.4865398,8.59422138 6.74038059,8.34038059 L12.7807612,2.3 Z M11.75,8.15 C11.75,7.79101491 12.0410149,7.5 12.4,7.5 C12.7589851,7.5 13.05,7.79101491 13.05,8.15 L13.05,12.05 C13.05,13.1269553 12.1769553,14 11.1,14 L3.95,14 C2.87304474,14 2,13.1269553 2,12.05 L2,4.9 C2,3.82304474 2.87304474,2.95 3.95,2.95 L7.85,2.95 C8.20898509,2.95 8.5,3.24101491 8.5,3.6 C8.5,3.95898509 8.20898509,4.25 7.85,4.25 L3.95,4.25 C3.59101491,4.25 3.3,4.54101491 3.3,4.9 L3.3,12.05 C3.3,12.4089851 3.59101491,12.7 3.95,12.7 L11.1,12.7 C11.4589851,12.7 11.75,12.4089851 11.75,12.05 L11.75,8.15 Z' fill='#005aa3'></path></svg>");});};$.fn.setActiveMenuItem=function(){$.each($('#body:not(.localist-body) #navbar').find('li'),function(){$(this).toggleClass('active',window.location.pathname.indexOf($(this).find('a').attr('href'))>-1);});};$.fn.menuColumns=function(){$('body:not(.toolbar-tray-open) ul.nav > li.dropdown .dropdown-menu > ul > li:nth-child(1)').each(function(){var overviewItem=$(this);var currentList=overviewItem.closest('ul');var newList=$('<ul>');newList.insertBefore(currentList);newList.append(overviewItem);});$('body:not(.toolbar-tray-open) ul.nav > li.dropdown .dropdown-menu > ul').each(function(){var secontList=$(this);var listLength=$(this).children().length;var halfLength=Math.round(listLength/2);var firstHalf=$(this).children().slice(0,halfLength);var anotherList=$('<ul>');anotherList.insertBefore(secontList);anotherList.append(firstHalf);});};$.fn.resetEybrowStuff=function(){var $window=$(window);var windowsize=$window.width();var searchFormRegion=$('.block-search-form-block');var quicklinksRegion=$('.quick-links ul.menu.nav');if(windowsize<768){$('.block-search-form-block input.form-search').attr("placeholder","Search...");if($('.block-search-form-block input.form-search').is(':focus'))e.preventDefault();$('#eyebrow .search').removeClass('expanded');$('#eyebrow .quick-links').removeClass('expanded');$('#navbar-collapse .region-navigation-collapsible').prepend(searchFormRegion);$('#block-quicklinks').append(quicklinksRegion);}else $('.block-search-form-block input.form-search').attr("placeholder","Type keywords and press enter...");};$.fn.quickLinks=function(){var quicklinksRegion=$('.region-navigation-quicklinks ul.menu.nav');$('#eyebrow .quick-links a, #eyebrow .quick-links svg').click(function(e){e.preventDefault();if($('#eyebrow .quick-links').hasClass('expanded')){$('#eyebrow .quick-links').removeClass('expanded');$('#eyebrow').removeClass('quick-links-expanded');$('#block-quicklinks').append(quicklinksRegion);}else{$('#eyebrow .search').removeClass('expanded');$('#eyebrow .quick-links').addClass('expanded');$('#eyebrow').addClass('quick-links-expanded');$('#eyebrow').removeClass('search-expanded');$('#eyebrow .quick-links').append(quicklinksRegion);}});};$.fn.searchForm=function(){$('#search-block-form #edit-actions').attr('id','block-edit-actions');$('.block-search-form-block input.form-search').attr("placeholder","Type keywords and press enter...");var searchFormRegion=$('.block-search-form-block');$('#eyebrow .search svg').click(function(e){e.preventDefault();if($('#eyebrow .search').hasClass('expanded')){$('#eyebrow .search').removeClass('expanded');$('#eyebrow').removeClass('search-expanded');$('#navbar-collapse .region-navigation-collapsible').prepend(searchFormRegion);}else{$('#eyebrow .quick-links').removeClass('expanded');$('#eyebrow .search').addClass('expanded');$('#eyebrow').addClass('search-expanded');$('#eyebrow').removeClass('quick-links-expanded');$('#eyebrow .search').append(searchFormRegion);$("#edit-keys").focus();}});};$.fn.closeMenus=function(){$('main, header .container-fluid').click(function(e){$.closeStuff();});};$.closeStuff=function(){if($('#eyebrow .quick-links').hasClass('expanded')){$('#eyebrow .quick-links').removeClass('expanded');$('#eyebrow').removeClass('quick-links-expanded');$('#block-quicklinks').append(quicklinksRegion);}if($('#eyebrow .search').hasClass('expanded')){$('#eyebrow .search').removeClass('expanded');$('#eyebrow').removeClass('search-expanded');$('#navbar-collapse .region-navigation-collapsible').prepend(searchFormRegion);}};$.fn.masonryGrid=function(){$('.count-4 .grid').masonry({itemSelector:'.grid-item',columnWidth:300});$('.count-3 .grid').masonry({itemSelector:'.grid-item',columnWidth:400});};$.fn.fnfItem=function(){$('.grid .grid-item.read-more').click(function(e){e.preventDefault();if($(this).hasClass('open'))$(this).removeClass('open');else $(this).addClass('open');});};$.fn.gridItemHeight=function(){$.each($('.grid-item.has-footer'),function(){var footerHeight=$(this).children('.item-footer').height();$(this).css('margin-bottom',footerHeight+'px');});};$.fn.equalHeightColumns=function(){$('.paragraph--type--blade.equal-height .columns').each(function(){var maxHeight=0;var elems=$(this).find('.paragraph--type--column .inner');elems.each(function(){$(this).removeAttr('style');maxHeight=$(this).height()>maxHeight?$(this).height():maxHeight;}).height(maxHeight);});};$.fn.equalHeightSlides=function(){$('.carousel').each(function(){var imgHeight=$(this).find('.active img').height();imgHeight=Math.floor(imgHeight);var imgHalf=(imgHeight/2);imgHalf=Math.floor(imgHalf);imgHeight=(imgHeight+10);var controls=$(this).find('.carousel-control');controls.each(function(){$(this).attr('style','top: '+imgHalf+'px;');});var indicators=$(this).find('.carousel-indicators');indicators.each(function(){$(this).attr('style','top: '+imgHeight+'px;');});var maxHeight=0;var elems=$(this).find('.item');elems.each(function(){maxHeight=$(this).height()>maxHeight?$(this).height():maxHeight;}).height(maxHeight);});};$.fn.initializeCarousel=function(){$('.carousel-static').find('.carousel').each(function(){$(this).carousel({pause:true,interval:false});});$('.carousel-autoscroll').find('.carousel').each(function(){$(this).carousel();});};$.fn.logoSize=function(){var y_scroll_pos=window.pageYOffset;var scroll_pos_test=150;if(y_scroll_pos>scroll_pos_test&&$('body').is(':not(.scroll)'))$('body').addClass('scroll');if(y_scroll_pos<scroll_pos_test&&$('body').hasClass('scroll'))$('body').removeClass('scroll');var secondaryHeaderHeight=$('.secondary-navigation').outerHeight();var target_height=secondaryHeaderHeight;var snavHtml=$('.region-secondary-navigation');if(y_scroll_pos>target_height)if($(window).width()>767){$('header.navbar').addClass('has-secondary-nav');$('header.navbar').append(snavHtml);}if(y_scroll_pos<=target_height)if($(window).width()>767){$('header.navbar').removeClass('has-secondary-nav');$('.secondary-navigation').append(snavHtml);$('.secondary-navigation, .region-secondary-navigation').removeAttr('style').attr('style','height: '+$('.secondary-navigation').outerHeight()+'px;');}};$.fn.subMenuFixed=function(){$('body').addClass('no-menu');$('.navbar-toggle').click(function(){if($('body').hasClass('no-menu')){$('body').removeClass('no-menu');$('body').addClass('mobile-menu');}else{$('body').addClass('no-menu');$('body').removeClass('mobile-menu');}$('body').topOffset();});};$.fn.topOffset=function(){var viewportWidth=$(window).width();if(viewportWidth<768){var navheight=parseInt($('#navbar .navbar-header').outerHeight())||0;var secondaryHeaderHeight=parseInt($('.secondary-navigation').outerHeight())||0;var toolbarheight=parseInt($('#toolbar-administration #toolbar-bar').outerHeight())||0;if($('body').hasClass('no-menu'))$('#body').css('margin-top',navheight);else $('#body').css('margin-top',navheight-toolbarheight);$('.navbar-header').css('margin-top',toolbarheight);if(secondaryHeaderHeight>0)$('.content-header').css('margin-top',secondaryHeaderHeight+20);}else{var navheight=$('#navbar').outerHeight();$('#body').css('margin-top',navheight);}};$.fn.alertMobile=function(){var alertHtml=$('.region-alert');var viewportWidth=$(window).width();if(viewportWidth<767)$('.navbar-header').prepend(alertHtml);else $('.navbar.navbar-fixed-top').prepend(alertHtml);};$.fn.alertControl=function(){var viewportWidth=$(window).width();var alertHeight=$('.region-alert').height();$('.region-alert').addClass('loaded');if(viewportWidth<767)var headerHeight=$('.navbar-header').height();else var headerHeight=$('header.navbar').height();var cookieValue=$.cookie('ucsb_alert');if(cookieValue=='collapsed')$('.alert').addClass('collapsed');$('.region-alert .alert .close').click(function(e){e.preventDefault();$('.alert').addClass('collapsed');$('body').topOffset();$.cookie('ucsb_alert','collapsed',{expires:1});});};$.fn.blogTopicFilter=function(){var pathname=window.location.pathname;var args=pathname.split('/');$('#topic-select option').each(function(){if($(this).val()==args[3])$(this).attr('selected','selected');});$('#blog-topic-filter').submit(function(e){e.preventDefault();var stub=$('#topic-select').val();var url='/blog/'+args[2]+'/'+stub;window.location.href=url;});};$.fn.blogFeatureArticle=function(){var nid=$('.view-blog-main .featured-post article').attr('data-history-node-id');$('.view-blog-main-rows .views-row').each(function(){var tid=$(this).find('article').attr('data-history-node-id');if(tid==nid)$(this).remove();});};$.fn.eventFormat=function(){$('#lw .lwn span.lwn0').each(function(){var theDate=($(this).text().trim().split(' '));$(this).html('<div class="month">'+theDate[0]+'</div><div class="day">'+theDate[1].replace(",","")+'</div>');});$('#lw li.lwe').each(function(){var imgSrc=$(this).find('img').attr('src');var itemLink=$(this).find('a').attr('href');$(this).attr('style','background-image: url("'+imgSrc+'")');$(this).click(function(){window.location.href=itemLink;});});};$.fn.secondaryNav=function(){$('.region-navigation-collapsible nav ul.nav a.dropdown-toggle').click(function(){if($(this).attr('aria-expanded')=='true')$('header#navbar').removeClass('submenu-open');else $('header#navbar').addClass('submenu-open');});$('.region-secondary-navigation').each(function(){var toggleButton='<span class="subnav-toggle"></span>';$(this).children('.block').prepend(toggleButton);});$('.secondary-navigation .subnav-toggle').click(function(){var secondaryHeaderHeight=$('.secondary-navigation').outerHeight();if($('.secondary-navigation').hasClass('expanded')){$(this).removeClass('open');$('.secondary-navigation').removeClass('expanded');$('.secondary-navigation').attr('style','height: '+secondaryHeaderHeight+'px;');}else{$(this).addClass('open');$('.secondary-navigation').addClass('expanded');$('.secondary-navigation').removeAttr('style');}});$('.secondary-navigation ul.menu.nav>li>a').click(function(){if($('.secondary-navigation').hasClass('expanded')){$('.secondary-navigation .subnav-toggle').removeClass('open');$('.secondary-navigation').removeClass('expanded');$('.secondary-navigation').attr('style','height: '+secondaryHeaderHeight+'px;');}});};$.fn.jumplink=function(){var viewportWidth=$(window).width();var headerHeight=0;if(viewportWidth<768){var navheight=parseInt($('#navbar .navbar-header').outerHeight())||0;var toolbarheight=parseInt($('#toolbar-administration #toolbar-bar').outerHeight())||0;var secondaryHeaderHeight=parseInt($('.secondary-navigation').outerHeight())||0;headerHeight=navheight+toolbarheight;if(secondaryHeaderHeight>0)headerHeight+=secondaryHeaderHeight;headerHeight+=20;}else{var navheight=parseInt($('#navbar').outerHeight())||0;var toolbarheight=parseInt($('#toolbar-administration #toolbar-bar').outerHeight())||0;if($('body').hasClass('toolbar-tray-open'))toolbarheight+=40;headerHeight=navheight+toolbarheight;var secondaryHeaderHeight=parseInt($('.secondary-navigation').outerHeight())||0;if(secondaryHeaderHeight>0)headerHeight+=secondaryHeaderHeight;}$('a[href*="#"]:not([href="#"],[href*="#collapse-"],[href*="#carousel-"])').click(function(){var target=$(this.hash);$('html,body').stop().animate({scrollTop:target.offset().top-headerHeight},'slow');});var hash=window.location.hash;if(hash==''||hash=='#'||hash==undefined)return false;var target=$(hash);target=target.length?target:$('[name='+hash.slice(1)+']');if(target.length)$('html,body').stop().animate({scrollTop:target.offset().top-headerHeight},'slow');};$.fn.menuScrollTop=function(){$('.navbar-header .navbar-toggle').addClass('collapsed');$('.navbar-header .navbar-toggle.collapsed').click(function(){$("html, body").animate({scrollTop:0},"fast");});};$.fn.blogTopicBreadcrumbFix=function(){$('.breadcrumb>li>a').each(function(){if($(this).attr('href')=='/blog/topic')$(this).parent('li').remove();});var viewTitle=$('h1.page-header').text();if(viewTitle.startsWith("Blog Topic:")){var newTitle=viewTitle.replace('Blog Topic:','Topic:');$('.breadcrumb>li:last-child').text(newTitle);}};$.fn.populateSearch=function(){var getUrlParameter=function getUrlParameter(sParam){var sPageURL=decodeURIComponent(window.location.search.substring(1)),sURLVariables=sPageURL.split('&'),sParameterName,i;for(i=0;i<sURLVariables.length;i++){sParameterName=sURLVariables[i].split('=');if(sParameterName[0]===sParam)return sParameterName[1]===undefined?true:sParameterName[1];}};var searchTerms=getUrlParameter('q');$('.content .form-search').attr('value',searchTerms);$('.gsc-results-wrapper-nooverlay').prepend('<h2>Search Results</h2>');};$(function(){$("iframe").each(function(){var iframe=$(this);iframe.removeAttr("width");iframe.removeAttr("frameborder");iframe.css("width","100%");if((iframe.attr("title")==undefined)||(iframe.attr("title")=="")){var url=iframe.prop("src");var hostname=$('<a>').prop('href',url).prop('hostname');var title="";if(url.includes("statuspage.io"))title="System Status Announcements";else if(url.includes("google.com/maps"))title="Google Map";else if(url.includes("calendar.google.com"))title="Google Calendar";else if(url.includes("youtube.com"))title="YouTube Video";else if(url.includes("facebook.com"))title="Facebook";else if(url.includes("twitter.com"))title="Twitter";else if(url.includes("instagram.com"))title="Instagram";else if(url.includes("issuu.com"))title="Issuu";else if(url.includes("vimeo.com"))title="Vimeo Video";else{if(url.includes("ucsb.dserec.com"))title="Recreation";}iframe.attr("title",title);}});});})(jQuery,Drupal);function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function')window.onload=func;else window.onload=function(){if(oldonload)oldonload();func();};};
!function(t,e){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["web/libraries/spectrum/test/jquery"],function(i){return e(t,i);}):"object"==typeof module&&module.exports?module.exports=e(t,require("web/libraries/spectrum/test/jquery")):t.jQueryBridget=e(t,t.jQuery);}(window,function(t,e){"use strict";function i(i,r,a){function h(t,e,n){var o,r="$()."+i+'("'+e+'")';return t.each(function(t,h){var u=a.data(h,i);if(!u)return void s(i+" not initialized. Cannot call methods, i.e. "+r);var d=u[e];if(!d||"_"==e.charAt(0))return void s(r+" is not a valid method");var l=d.apply(u,n);o=void 0===o?l:o;}),void 0!==o?o:t;}function u(t,e){t.each(function(t,n){var o=a.data(n,i);o?(o.option(e),o._init()):(o=new r(n,e),a.data(n,i,o));});}a=a||e||t.jQuery,a&&(r.prototype.option||(r.prototype.option=function(t){a.isPlainObject(t)&&(this.options=a.extend(!0,this.options,t));}),a.fn[i]=function(t){if("string"==typeof t){var e=o.call(arguments,1);return h(this,t,e);}return u(this,t),this;},n(a));}function n(t){!t||t&&t.bridget||(t.bridget=i);}var o=Array.prototype.slice,r=t.console,s="undefined"==typeof r?function(){}:function(t){r.error(t);};return n(e||t.jQuery),i;}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e();}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return -1==n.indexOf(e)&&n.push(e),this;}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||{};return n[e]=!0,this;}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return -1!=n&&i.splice(n,1),this;}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,o=i[n];e=e||[];for(var r=this._onceEvents&&this._onceEvents[t];o;){var s=r&&r[o];s&&(this.off(t,o),delete r[o]),o.apply(this,e),n+=s?0:1,o=i[n];}return this;}},t;}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("get-size/get-size",[],function(){return e();}):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e();}(window,function(){"use strict";function t(t){var e=parseFloat(t),i=-1==t.indexOf("%")&&!isNaN(e);return i&&e;}function e(){}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;u>e;e++){var i=h[e];t[i]=0;}return t;}function n(t){var e=getComputedStyle(t);return e||a("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),e;}function o(){if(!d){d=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(e);var o=n(e);r.isBoxSizeOuter=s=200==t(o.width),i.removeChild(e);}}function r(e){if(o(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var r=n(e);if("none"==r.display)return i();var a={};a.width=e.offsetWidth,a.height=e.offsetHeight;for(var d=a.isBorderBox="border-box"==r.boxSizing,l=0;u>l;l++){var c=h[l],f=r[c],m=parseFloat(f);a[c]=isNaN(m)?0:m;}var p=a.paddingLeft+a.paddingRight,g=a.paddingTop+a.paddingBottom,y=a.marginLeft+a.marginRight,v=a.marginTop+a.marginBottom,_=a.borderLeftWidth+a.borderRightWidth,z=a.borderTopWidth+a.borderBottomWidth,E=d&&s,b=t(r.width);b!==!1&&(a.width=b+(E?0:p+_));var x=t(r.height);return x!==!1&&(a.height=x+(E?0:g+z)),a.innerWidth=a.width-(p+_),a.innerHeight=a.height-(g+z),a.outerWidth=a.width+y,a.outerHeight=a.height+v,a;}}var s,a="undefined"==typeof console?e:function(t){console.error(t);},h=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],u=h.length,d=!1;return r;}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e();}(window,function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return "matches";if(t.matchesSelector)return "matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i],o=n+"MatchesSelector";if(t[o])return o;}}();return function(e,i){return e[t](i);};}),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(i){return e(t,i);}):"object"==typeof module&&module.exports?module.exports=e(t,require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.matchesSelector);}(window,function(t,e){var i={};i.extend=function(t,e){for(var i in e)t[i]=e[i];return t;},i.modulo=function(t,e){return (t%e+e)%e;},i.makeArray=function(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"object"==typeof t&&"number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e;},i.removeFrom=function(t,e){var i=t.indexOf(e);-1!=i&&t.splice(i,1);},i.getParent=function(t,i){for(;t!=document.body;)if(t=t.parentNode,e(t,i))return t;},i.getQueryElement=function(t){return "string"==typeof t?document.querySelector(t):t;},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t);},i.filterFindElements=function(t,n){t=i.makeArray(t);var o=[];return t.forEach(function(t){if(t instanceof HTMLElement){if(!n)return void o.push(t);e(t,n)&&o.push(t);for(var i=t.querySelectorAll(n),r=0;r<i.length;r++)o.push(i[r]);}}),o;},i.debounceMethod=function(t,e,i){var n=t.prototype[e],o=e+"Timeout";t.prototype[e]=function(){var t=this[o];t&&clearTimeout(t);var e=arguments,r=this;this[o]=setTimeout(function(){n.apply(r,e),delete r[o];},i||100);};},i.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t);},i.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i;}).toLowerCase();};var n=t.console;return i.htmlInit=function(e,o){i.docReady(function(){var r=i.toDashed(o),s="data-"+r,a=document.querySelectorAll("["+s+"]"),h=document.querySelectorAll(".js-"+r),u=i.makeArray(a).concat(i.makeArray(h)),d=s+"-options",l=t.jQuery;u.forEach(function(t){var i,r=t.getAttribute(s)||t.getAttribute(d);try{i=r&&JSON.parse(r);}catch(a){return void (n&&n.error("Error parsing "+s+" on "+t.className+": "+a));}var h=new e(t,i);l&&l.data(t,o,h);});});},i;}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("ev-emitter"),require("get-size")):(t.Outlayer={},t.Outlayer.Item=e(t.EvEmitter,t.getSize));}(window,function(t,e){"use strict";function i(t){for(var e in t)return !1;return e=null,!0;}function n(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create());}function o(t){return t.replace(/([A-Z])/g,function(t){return "-"+t.toLowerCase();});}var r=document.documentElement.style,s="string"==typeof r.transition?"transition":"WebkitTransition",a="string"==typeof r.transform?"transform":"WebkitTransform",h={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[s],u={transform:a,transition:s,transitionDuration:s+"Duration",transitionProperty:s+"Property",transitionDelay:s+"Delay"},d=n.prototype=Object.create(t.prototype);d.constructor=n,d._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"});},d.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t);},d.getSize=function(){this.size=e(this.element);},d.css=function(t){var e=this.element.style;for(var i in t){var n=u[i]||i;e[n]=t[i];}},d.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),n=t[e?"left":"right"],o=t[i?"top":"bottom"],r=this.layout.size,s=-1!=n.indexOf("%")?parseFloat(n)/100*r.width:parseInt(n,10),a=-1!=o.indexOf("%")?parseFloat(o)/100*r.height:parseInt(o,10);s=isNaN(s)?0:s,a=isNaN(a)?0:a,s-=e?r.paddingLeft:r.paddingRight,a-=i?r.paddingTop:r.paddingBottom,this.position.x=s,this.position.y=a;},d.layoutPosition=function(){var t=this.layout.size,e={},i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop"),o=i?"paddingLeft":"paddingRight",r=i?"left":"right",s=i?"right":"left",a=this.position.x+t[o];e[r]=this.getXValue(a),e[s]="";var h=n?"paddingTop":"paddingBottom",u=n?"top":"bottom",d=n?"bottom":"top",l=this.position.y+t[h];e[u]=this.getYValue(l),e[d]="",this.css(e),this.emitEvent("layout",[this]);},d.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px";},d.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px";},d._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,o=parseInt(t,10),r=parseInt(e,10),s=o===this.position.x&&r===this.position.y;if(this.setPosition(t,e),s&&!this.isTransitioning)return void this.layoutPosition();var a=t-i,h=e-n,u={};u.transform=this.getTranslate(a,h),this.transition({to:u,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0});},d.getTranslate=function(t,e){var i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop");return t=i?t:-t,e=n?e:-e,"translate3d("+t+"px, "+e+"px, 0)";},d.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition();},d.moveTo=d._transitionTo,d.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10);},d._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this);},d.transition=function(t){if(!parseFloat(this.layout.options.transitionDuration))return void this._nonTransition(t);var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);var n=this.element.offsetHeight;n=null;}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0;};var l="opacity,"+o(a);d.enableTransition=function(){if(!this.isTransitioning){var t=this.layout.options.transitionDuration;t="number"==typeof t?t+"ms":t,this.css({transitionProperty:l,transitionDuration:t,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(h,this,!1);}},d.onwebkitTransitionEnd=function(t){this.ontransitionend(t);},d.onotransitionend=function(t){this.ontransitionend(t);};var c={"-webkit-transform":"transform"};d.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,n=c[t.propertyName]||t.propertyName;if(delete e.ingProperties[n],i(e.ingProperties)&&this.disableTransition(),n in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[n]),n in e.onEnd){var o=e.onEnd[n];o.call(this),delete e.onEnd[n];}this.emitEvent("transitionEnd",[this]);}},d.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(h,this,!1),this.isTransitioning=!1;},d._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e);};var f={transitionProperty:"",transitionDuration:"",transitionDelay:""};return d.removeTransitionStyles=function(){this.css(f);},d.stagger=function(t){t=isNaN(t)?0:t,this.staggerDelay=t+"ms";},d.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this]);},d.remove=function(){return s&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem();}),void this.hide()):void this.removeElem();},d.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("visibleStyle");e[i]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e});},d.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal");},d.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return "opacity";for(var i in e)return i;},d.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("hiddenStyle");e[i]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e});},d.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"));},d.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""});},n;}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,n,o,r){return e(t,i,n,o,r);}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):t.Outlayer=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,t.Outlayer.Item);}(window,function(t,e,i,n,o){"use strict";function r(t,e){var i=n.getQueryElement(t);if(!i)return void (h&&h.error("Bad element for "+this.constructor.namespace+": "+(i||t)));this.element=i,u&&(this.$element=u(this.element)),this.options=n.extend({},this.constructor.defaults),this.option(e);var o=++l;this.element.outlayerGUID=o,c[o]=this,this._create();var r=this._getOption("initLayout");r&&this.layout();}function s(t){function e(){t.apply(this,arguments);}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e;}function a(t){if("number"==typeof t)return t;var e=t.match(/(^\d*\.?\d*)(\w*)/),i=e&&e[1],n=e&&e[2];if(!i.length)return 0;i=parseFloat(i);var o=m[n]||1;return i*o;}var h=t.console,u=t.jQuery,d=function(){},l=0,c={};r.namespace="outlayer",r.Item=o,r.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var f=r.prototype;n.extend(f,e.prototype),f.option=function(t){n.extend(this.options,t);},f._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t];},r.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},f._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),n.extend(this.element.style,this.options.containerStyle);var t=this._getOption("resize");t&&this.bindResize();},f.reloadItems=function(){this.items=this._itemize(this.element.children);},f._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,n=[],o=0;o<e.length;o++){var r=e[o],s=new i(r,this);n.push(s);}return n;},f._filterFindItemElements=function(t){return n.filterFindElements(t,this.options.itemSelector);},f.getItemElements=function(){return this.items.map(function(t){return t.element;});},f.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0;},f._init=f.layout,f._resetLayout=function(){this.getSize();},f.getSize=function(){this.size=i(this.element);},f._getMeasurement=function(t,e){var n,o=this.options[t];o?("string"==typeof o?n=this.element.querySelector(o):o instanceof HTMLElement&&(n=o),this[t]=n?i(n)[e]:o):this[t]=0;},f.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout();},f._getItemsForLayout=function(t){return t.filter(function(t){return !t.isIgnored;});},f._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var i=[];t.forEach(function(t){var n=this._getItemLayoutPosition(t);n.item=t,n.isInstant=e||t.isLayoutInstant,i.push(n);},this),this._processLayoutQueue(i);}},f._getItemLayoutPosition=function(){return {x:0,y:0};},f._processLayoutQueue=function(t){this.updateStagger(),t.forEach(function(t,e){this._positionItem(t.item,t.x,t.y,t.isInstant,e);},this);},f.updateStagger=function(){var t=this.options.stagger;return null===t||void 0===t?void (this.stagger=0):(this.stagger=a(t),this.stagger);},f._positionItem=function(t,e,i,n,o){n?t.goTo(e,i):(t.stagger(o*this.stagger),t.moveTo(e,i));},f._postLayout=function(){this.resizeContainer();},f.resizeContainer=function(){var t=this._getOption("resizeContainer");if(t){var e=this._getContainerSize();e&&(this._setContainerMeasure(e.width,!0),this._setContainerMeasure(e.height,!1));}},f._getContainerSize=d,f._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px";}},f._emitCompleteOnItems=function(t,e){function i(){o.dispatchEvent(t+"Complete",null,[e]);}function n(){s++,s==r&&i();}var o=this,r=e.length;if(!e||!r)return void i();var s=0;e.forEach(function(e){e.once(t,n);});},f.dispatchEvent=function(t,e,i){var n=e?[e].concat(i):i;if(this.emitEvent(t,n),u)if(this.$element=this.$element||u(this.element),e){var o=u.Event(e);o.type=t,this.$element.trigger(o,i);}else this.$element.trigger(t,i);},f.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0);},f.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored;},f.stamp=function(t){t=this._find(t),t&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this));},f.unstamp=function(t){t=this._find(t),t&&t.forEach(function(t){n.removeFrom(this.stamps,t),this.unignore(t);},this);},f._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n.makeArray(t)):void 0;},f._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this));},f._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)};},f._manageStamp=d,f._getElementOffset=function(t){var e=t.getBoundingClientRect(),n=this._boundingRect,o=i(t),r={left:e.left-n.left-o.marginLeft,top:e.top-n.top-o.marginTop,right:n.right-e.right-o.marginRight,bottom:n.bottom-e.bottom-o.marginBottom};return r;},f.handleEvent=n.handleEvent,f.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0;},f.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1;},f.onresize=function(){this.resize();},n.debounceMethod(r,"onresize",100),f.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout();},f.needsResizeLayout=function(){var t=i(this.element),e=this.size&&t;return e&&t.innerWidth!==this.size.innerWidth;},f.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e;},f.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e));},f.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i);}},f.reveal=function(t){if(this._emitCompleteOnItems("reveal",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.reveal();});}},f.hide=function(t){if(this._emitCompleteOnItems("hide",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.hide();});}},f.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e);},f.hideItemElements=function(t){var e=this.getItems(t);this.hide(e);},f.getItem=function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.element==t)return i;}},f.getItems=function(t){t=n.makeArray(t);var e=[];return t.forEach(function(t){var i=this.getItem(t);i&&e.push(i);},this),e;},f.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach(function(t){t.remove(),n.removeFrom(this.items,t);},this);},f.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach(function(t){t.destroy();}),this.unbindResize();var e=this.element.outlayerGUID;delete c[e],delete this.element.outlayerGUID,u&&u.removeData(this.element,this.constructor.namespace);},r.data=function(t){t=n.getQueryElement(t);var e=t&&t.outlayerGUID;return e&&c[e];},r.create=function(t,e){var i=s(r);return i.defaults=n.extend({},r.defaults),n.extend(i.defaults,e),i.compatOptions=n.extend({},r.compatOptions),i.namespace=t,i.data=r.data,i.Item=s(o),n.htmlInit(i,t),u&&u.bridget&&u.bridget(t,i),i;};var m={ms:1,s:1e3};return r.Item=o,r;}),function(t,e){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("outlayer"),require("get-size")):t.Masonry=e(t.Outlayer,t.getSize);}(window,function(t,e){var i=t.create("masonry");i.compatOptions.fitWidth="isFitWidth";var n=i.prototype;return n._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0;},n.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],i=t&&t.element;this.columnWidth=i&&e(i).outerWidth||this.containerWidth;}var n=this.columnWidth+=this.gutter,o=this.containerWidth+this.gutter,r=o/n,s=n-o%n,a=s&&1>s?"round":"floor";r=Math[a](r),this.cols=Math.max(r,1);},n.getContainerWidth=function(){var t=this._getOption("fitWidth"),i=t?this.element.parentNode:this.element,n=e(i);this.containerWidth=n&&n.innerWidth;},n._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,i=e&&1>e?"round":"ceil",n=Math[i](t.size.outerWidth/this.columnWidth);n=Math.min(n,this.cols);for(var o=this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition",r=this[o](n,t),s={x:this.columnWidth*r.col,y:r.y},a=r.y+t.size.outerHeight,h=n+r.col,u=r.col;h>u;u++)this.colYs[u]=a;return s;},n._getTopColPosition=function(t){var e=this._getTopColGroup(t),i=Math.min.apply(Math,e);return {col:e.indexOf(i),y:i};},n._getTopColGroup=function(t){if(2>t)return this.colYs;for(var e=[],i=this.cols+1-t,n=0;i>n;n++)e[n]=this._getColGroupY(n,t);return e;},n._getColGroupY=function(t,e){if(2>e)return this.colYs[t];var i=this.colYs.slice(t,t+e);return Math.max.apply(Math,i);},n._getHorizontalColPosition=function(t,e){var i=this.horizontalColIndex%this.cols,n=t>1&&i+t>this.cols;i=n?0:i;var o=e.size.outerWidth&&e.size.outerHeight;return this.horizontalColIndex=o?i+t:this.horizontalColIndex,{col:i,y:this._getColGroupY(i,t)};},n._manageStamp=function(t){var i=e(t),n=this._getElementOffset(t),o=this._getOption("originLeft"),r=o?n.left:n.right,s=r+i.outerWidth,a=Math.floor(r/this.columnWidth);a=Math.max(0,a);var h=Math.floor(s/this.columnWidth);h-=s%this.columnWidth?0:1,h=Math.min(this.cols-1,h);for(var u=this._getOption("originTop"),d=(u?n.top:n.bottom)+i.outerHeight,l=a;h>=l;l++)this.colYs[l]=Math.max(d,this.colYs[l]);},n._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t;},n._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return (this.cols-t)*this.columnWidth-this.gutter;},n.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth;},i;});;
(function(factory){if(typeof define==='function'&&define.amd)define(['web/libraries/spectrum/test/jquery'],factory);else if(typeof exports==='object')module.exports=factory(require('web/libraries/spectrum/test/jquery'));else factory(jQuery);}(function($){var pluses=/\+/g;function encode(s){return config.raw?s:encodeURIComponent(s);}function decode(s){return config.raw?s:decodeURIComponent(s);}function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value));}function parseCookieValue(s){if(s.indexOf('"')===0)s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');try{s=decodeURIComponent(s.replace(pluses,' '));return config.json?JSON.parse(s):s;}catch(e){}}function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value;}var config=$.cookie=function(key,value,options){if(arguments.length>1&&!$.isFunction(value)){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setMilliseconds(t.getMilliseconds()+days*864e+5);}return (document.cookie=[encode(key),'=',stringifyCookieValue(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}var result=key?undefined:{},cookies=document.cookie?document.cookie.split('; '):[],i=0,l=cookies.length;for(;i<l;i++){var parts=cookies[i].split('='),name=decode(parts.shift()),cookie=parts.join('=');if(key===name){result=read(cookie,value);break;}if(!key&&(cookie=read(cookie))!==undefined)result[name]=cookie;}return result;};config.defaults={};$.removeCookie=function(key,options){$.cookie(key,'',$.extend({},options,{expires:-1}));return !$.cookie(key);};}));;
